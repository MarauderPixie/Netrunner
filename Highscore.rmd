---
title: "Highscoreliste"
author: "Tobias Anton"
date: "`r ddateR::poee()`"
output:
  rmdformats::html_clean:
    fig_width: 10
    dpi: 360
    highlight: tango
    theme: spacelab
---

```{r, message=F, warning=FALSE, include=FALSE}
source(paste0(Sys.getenv("PROJECT_HOME"), "./init.r"))
knitr::opts_chunk$set(echo = F, fig.path = "plots/", warning = F, message = F)
```

# Arena Highscore-Liste

W채hrend ein Ligaspiel aus zwei Runden besteht (jede/r SpielerIn je einmal Kon **und** Runner) wird hier eine Runde bereits als ganzes Spiel gez채hlt (entweder Kon **oder** Runner).

```{r, Die_Liste}
  score %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(desc(Ratio), desc(Siege), Spiele) %>% 
    format_table(list(
      Ratio  = proportion_bar("pink"),
      Spiele = color_tile("white", "lightgreen"),
      Siege  = formatter("span",
                          style = x ~ ifelse(x >= 10, style(color = "blue"), NA))
                      ), check.rows = F, format = "pandoc")
```

## Siege pro Woche pro Spieler (pro ID)

Durch klicken auf die Namen in der Legende und in der oberen Leiste bekommt man das etwas 체bersichtlicher; an brauchbaren Defaults arbeite ich noch...

```{r WochenspielerIDsiege}
  score %>%
    group_by(Kalenderwoche, Spieler) %>% 
    summarize("Wins" = sum(Punkte)/2,
              "IDs"  = paste(unique(ID), collapse = ",")) %>%
    plot_ly(., x = Kalenderwoche, y = Wins, line = list(shape = "spline"),
            color = Spieler, text = str_replace_all(IDs, ",", "<br />"))
```

## Siege nach Seite

```{r, Seitenliste}
  score %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne}
  score %>% 
    filter(Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner}
  score %>% 
    filter(Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Spielh채ufigkeiten

### nach Fraktion

```{r, IDs, echo = F}
  ggplot(score, aes(x = Fraktion, fill = Fraktion)) +
    geom_bar(color = "black") +
    labs(x = "", y = "Spiele") +
    facet_grid(. ~ Seite, scales = "free_x") +
    faction_fill +
    cosmetics +
    theme(legend.position = "none")
```
  
### nach ID

```{r, IDs_Konzern, echo = F}
  score %>% 
    filter(Seite == "Konzern") %>% 
    ggplot(aes(x = ID, fill = Fraktion)) +
      geom_bar(color = "black") +
      labs(x = "", y = "Spiele", legend = "") +
      facet_grid(. ~ Fraktion, scales = "free") +
      kon_fill +
      cosmetics +
      theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1),
            legend.position = "none")
```

```{r, IDs_Runner, echo = F}
  score %>% 
    filter(Seite == "Runner") %>% 
    ggplot(aes(x = ID, fill = Fraktion)) +
      geom_bar(color = "black") +
      labs(x = "", y = "Spiele") +
      facet_grid(. ~ Fraktion, scales = "free") +
      run_fill +
      cosmetics +
      theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1),
            legend.position = "none")
```

# Kalenderwoche 2

```{r, KW2}
  score %>% 
    filter(Kalenderwoche == 2) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw2}
  score %>% 
    filter(Kalenderwoche == 2) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw2}
  score %>% 
    filter(Kalenderwoche == 2, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw2}
  score %>% 
    filter(Seite == "Runner", Kalenderwoche == 2) %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

# Kalenderwoche 3

```{r, kw3}
  score %>% 
    filter(Kalenderwoche == 3) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw3}
  score %>% 
    filter(Kalenderwoche == 3) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw3}
  score %>% 
    filter(Kalenderwoche == 3, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw3}
  score %>% 
    filter(Kalenderwoche == 3, Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

# Kalenderwoche 4

```{r, kw4}
  score %>% 
    filter(Kalenderwoche == 4) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw4}
  score %>% 
    filter(Kalenderwoche == 4) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw4}
  score %>% 
    filter(Kalenderwoche == 4, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw4}
  score %>% 
    filter(Kalenderwoche == 4, Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

# Kalenderwoche 5

```{r, kw5}
  score %>% 
    filter(Kalenderwoche == 5) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw5}
  score %>% 
    filter(Kalenderwoche == 5) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw5}
  score %>% 
    filter(Kalenderwoche == 5, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw5}
  score %>% 
    filter(Kalenderwoche == 5, Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```


# Kalenderwoche 6

```{r, kw6}
  score %>% 
    filter(Kalenderwoche == 6) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw6}
  score %>% 
    filter(Kalenderwoche == 6) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw6}
  score %>% 
    filter(Kalenderwoche == 6, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw6}
  score %>% 
    filter(Kalenderwoche == 6, Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```


# Kalenderwoche 7

```{r, kw7}
  score %>% 
    filter(Kalenderwoche == 7) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw7}
  score %>% 
    filter(Kalenderwoche == 7) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw7}
  score %>% 
    filter(Kalenderwoche == 7, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw7}
  score %>% 
    filter(Kalenderwoche == 7, Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```


# Kalenderwoche 8

```{r, kw8}
  score %>% 
    filter(Kalenderwoche == 8) %>% 
    group_by(Spieler) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Seite

```{r, Seitenliste_kw8}
  score %>% 
    filter(Kalenderwoche == 8) %>% 
    group_by(Seite) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

## Siege nach Fraktion

### Konzerne

```{r, Fraktionsliste_Konzerne_kw8}
  score %>% 
    filter(Kalenderwoche == 8, Seite == "Konzern") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

### Runner

```{r, Fraktionsliste_Runner_kw8}
  score %>% 
    filter(Kalenderwoche == 8, Seite == "Runner") %>% 
    group_by(Fraktion) %>% 
    summarize("Spiele" = n(),
              "Siege" = sum(Punkte)/2,
              "Ratio" = percent((sum(Punkte)/2)/Spiele, 1)) %>%
    arrange(Spiele) %>% 
    arrange(desc(Siege)) %>%
    arrange(desc(Ratio)) %>% 
    knitr::kable()
```

